(()=>{var e={};e.id=78,e.ids=[78],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79305:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>v,routeModule:()=>m,serverHooks:()=>y,workAsyncStorage:()=>P,workUnitAsyncStorage:()=>f});var a={};t.r(a),t.d(a,{POST:()=>l});var s=t(42706),o=t(28203),n=t(45994);class i{calculatePosterPrice(e,r,t){return e.dimensions[r]?.price+e.frames[t]?.price}calculateCartPosterPrice(e,r){return(e.dimension.price+e.frame.price)*r}}let d=new i;class c{isInCart(e,r){return!!r.find(r=>r.cartPoster._id==e._id&&r.cartPoster.dimensionId==e.dimensionId&&r.cartPoster.frameId==e.frameId)}getTotalQuantity(e){return e.map(e=>e.quantity).reduce((e,r)=>e+r,0)}getTotalPrice(e){return e?.map(e=>d.calculateCartPosterPrice(e.cartPoster,e.quantity)).reduce((e,r)=>e+r,0)||0}}let u=new c;var p=t(39187);async function l(e){try{let r=await e.json(),t=`
Поступил заказ: %0A
Имя: ${r.orderInfo.name} %0A
Фамилия: ${r.orderInfo.surname} %0A
Номер телефона: ${r.orderInfo.phone} %0A
Доставка: ${r.orderInfo.deliveryType} %0A
Дата доставки: ${r.orderInfo.deliveryDate} %0A
${r.orderInfo.deliveryTime?`Время доставки: ${r.orderInfo.deliveryTime} %0A`:""}
${r.orderInfo.deliveryAddress?`Адрес доставки: ${r.orderInfo.deliveryAddress} %0A`:""}%0A
Заказаны товары:%0A
${r.cartList.map(e=>`Название: ${e.cartPoster.name}, размер: ${e.cartPoster.dimension.name}, рамка: ${e.cartPoster.frame.name}, общая цена: ${d.calculateCartPosterPrice(e.cartPoster,e.quantity)} количество: ${e.quantity}`).join("%0A")}%0A%0A
Цена товаров: ${u.getTotalPrice(r.cartList)}руб.%0A
Цена доставки: ${r.deliveryType.price}руб.%0A
Итоговая цена: ${r.deliveryType.price+u.getTotalPrice(r.cartList)}руб.`;await fetch(`https://api.telegram.org/bot${process.env.BOT_API_TOKEN}/sendMessage?chat_id=-4673291479&text=${t}`)}catch(e){return console.log(e),new p.NextResponse(JSON.stringify(e),{status:500})}return new p.NextResponse(JSON.stringify("Done"),{status:200})}let m=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/order/route",pathname:"/api/order",filename:"route",bundlePath:"app/api/order/route"},resolvedPagePath:"C:\\Work\\melpomena\\frontend\\src\\app\\api\\order\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:P,workUnitAsyncStorage:f,serverHooks:y}=m;function v(){return(0,n.patchFetch)({workAsyncStorage:P,workUnitAsyncStorage:f})}},96487:()=>{},78335:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,452],()=>t(79305));module.exports=a})();